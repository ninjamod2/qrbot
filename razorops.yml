version: 1
stages:
  - setup
  - test
  - deploy

steps:
  setup:
    stage: setup
    image: python:3.11
    commands:
      - echo "ğŸ”§ Setting up Python environment..."
      - python -m venv venv
      - source venv/bin/activate
      - echo "â¬†ï¸ Upgrading pip..."
      - pip install --upgrade pip
      - echo "ğŸ“¦ Installing required modules..."
      - pip install python-telegram-bot==20.8 apscheduler==3.10.4
      - pip install --no-cache-dir json5 pytz
      - echo "âœ… Environment ready."

  test:
    stage: test
    image: python:3.11
    commands:
      - source venv/bin/activate
      - echo "ğŸ§ª Running code checks..."
      - python -m py_compile main.py || echo "âš ï¸ Code check failed (but continuing)"
      - echo "âœ… Python syntax check complete."

  deploy:
    stage: deploy
    image: alpine:latest
    commands:
      - echo "ğŸš€ Deployment step started..."
      # Example: if you want to run the bot in background on server
      # python main.py &
      - echo "Customize this step with your deploy method (e.g., Docker, SSH, etc.)"
      - echo "âœ… Deployment complete."
